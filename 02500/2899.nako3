### [ä½œå“æƒ…å ±]
### æ²è¼‰URL=https://n3s.nadesi.com/id.php?2899
### ã‚¿ã‚¤ãƒˆãƒ«=Jspreadsheetã§ã‚¨ã‚¯ã‚»ãƒ«ï¼Ÿã£ã½ã„ã‚‚ã®ã¤ãã‚ŠãŸã„
### ä½œè€…=é›ªä¹ƒâ˜†é›«(user_id=0)
### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹=CC0
### èª¬æ˜=è²¯è”µåº«ã®CSSã‚’æ”»ç•¥ã™ã‚‹ã®ãƒ„ãƒ©ã‚¤ğŸ˜­
### å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³=3.6.26
### URL=
### ç¨®é¡=wnako
### ã‚¿ã‚°=ãƒ†ã‚¹ãƒˆ
### æ›´æ–°æ—¥æ™‚=2024-11-15 18:16:10
###

ï¼ƒJspreadsheetã®å–ã‚Šè¾¼ã¿
!ã€Œhttps://n3s.nadesi.com/plain/LoadScript.jsã€ã‚’å–ã‚Šè¾¼ã‚€ã€‚
ã€Œhttps://bossanova.uk/jspreadsheet/v4/jexcel.jsã€ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ã€‚
ã€Œhttps://bossanova.uk/jspreadsheet/v4/jexcel.cssã€ã®CSSãƒªãƒ³ã‚¯ä½œæˆã€‚
ã€Œhttps://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.jsã€ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ã€‚
ã€Œhttps://cdn.jsdelivr.net/npm/jsuites/dist/jsuites.min.cssã€ã®CSSãƒªãƒ³ã‚¯ä½œæˆã€‚

ï¼ƒãƒ‡ãƒ¼ã‚¿ä½œæˆ
ã‚¿ã‚¤ãƒˆãƒ«ï¼[
        { title:'æ®‹ã‚Šæ—¥æ•°',type: 'text', width:100 },
        { title:'æ—¥ä»˜',type: 'calendar',options: { format:'YYYY/MM/DD' }, width:120 },
        { title:'æ›œæ—¥',type: 'text', width:50 },
        { title:'å®Œäº†',type: 'checkbox', width:50 },
        { title:'äºˆå®š',type: 'text', width:300 },
    ]

ï¼ƒï¼ƒã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
csvï¼ç©ºã€‚
ã‚¹ã‚¿ã‚¤ãƒ«ï¼ç©ºè¾æ›¸ã€‚

é–‹å§‹æ—¥ï¼ä»Šæ—¥ã€‚
çµ‚äº†æ—¥ï¼ã€Œ2024/12/25ã€
äºˆå®šãƒ‡ãƒ¼ã‚¿ï¼{
    "2024/12/01":"ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é–‹å§‹æ—¥",
    "2024/12/25":"ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœ€çµ‚æ—¥"
    }
å¯¾è±¡æ—¥ï¼é–‹å§‹æ—¥ã€‚
å¯¾è±¡ç§’ï¼å¯¾è±¡æ—¥ã‚’UNIXTIMEå¤‰æ›ã€‚
æ®‹ã‚Šæ—¥æ•°ï¼é–‹å§‹æ—¥ã¨çµ‚äº†æ—¥ã®æ—¥æ•°å·®ã€‚
æ®‹ã‚Šæ—¥æ•°+1å›
  Fæ›œæ—¥ï¼å¯¾è±¡æ—¥ã®æ›œæ—¥ã€‚
  //ã‚¹ã‚¿ã‚¤ãƒ«ä½œæˆ
  ã‚‚ã—ã€Fæ›œæ—¥ï¼ã€Œæ—¥ã€ãªã‚‰ã°ã€
    ã‚¹ã‚¿ã‚¤ãƒ«["C{å›æ•°}"]ï¼ã€Œbackground-color: red;ã€ã€‚
  é•ãˆã°ã€ã‚‚ã—ã€Fæ›œæ—¥ï¼ã€ŒåœŸã€ãªã‚‰ã°ã€
    ã‚¹ã‚¿ã‚¤ãƒ«["C{å›æ•°}"]ï¼ã€Œbackground-color: blue;ã€ã€‚
  é•ãˆã°ã€
    ã‚¹ã‚¿ã‚¤ãƒ«["C{å›æ•°}"]ï¼ã€Œbackground-color: #eee;ã€ã€‚
  ã“ã“ã¾ã§ã€‚
  Fæ—¥ä»˜ï¼å¯¾è±¡æ—¥//ã®ã€Œ/ã€ã‚’ã€Œ,ã€ã«ç½®æ›ã€‚
  Fäºˆå®šï¼äºˆå®šãƒ‡ãƒ¼ã‚¿[å¯¾è±¡æ—¥]
  ã‚‚ã—ï¼ˆFäºˆå®šï¼æœªå®šç¾©ï¼‰ãªã‚‰ã°ã€Fäºˆå®š=ç©ºã€‚
  csvï¼csvã«ã€Œæ®‹ã‚Š{æ®‹ã‚Šæ—¥æ•°}æ—¥,{Fæ—¥ä»˜},{Fæ›œæ—¥},false,{Fäºˆå®š}ã€ã‚’ä¸€è¡Œè¿½åŠ ã€‚ã€‚
  æ®‹ã‚Šæ—¥æ•°ï¼æ®‹ã‚Šæ—¥æ•°âˆ’1
  å¯¾è±¡ç§’ï¼å¯¾è±¡ç§’ï¼‹(60 * 60 * 24)
  å¯¾è±¡æ—¥ï¼å¯¾è±¡ç§’ã‚’æ—¥æ™‚å¤‰æ›ã—ã¦ã€Œ ã€ã¾ã§åˆ‡ã‚Šå–ã‚‹ã€‚
ã“ã“ã¾ã§ã€‚
ãƒ‡ãƒ¼ã‚¿ï¼csvã‚’CSVå–å¾—ã€‚

yï¼ç©ºã€‚å¯¾è±¡è¦ç´ ï¼ç©ºã€‚
â—(ã‚»ãƒ«ã®xyã¨å€¤ã§)å®Œäº†è¨­å®š
    åˆ—,è¡Œï¼xyã€‚yï¼è¡Œã€‚å¯¾è±¡è¦ç´ ï¼ã‚»ãƒ«["parentElement"]ã€‚
    ã‚‚ã—ï¼ˆåˆ—ï¼ï¼“ï¼‰ãªã‚‰ã°ã€
        ã‚‚ã—ï¼ˆå€¤ï¼TRUEï¼‰ãªã‚‰ã°ã€
            å¯¾è±¡è¦ç´ ã®ã€ŒèƒŒæ™¯è‰²ã€ã«é»„è‰²ã‚’DOMã‚¹ã‚¿ã‚¤ãƒ«è¨­å®šã€‚
        é•ãˆã°ã€
            å¯¾è±¡è¦ç´ ã®ã€ŒèƒŒæ™¯è‰²ã€ã«ç™½è‰²ã‚’DOMã‚¹ã‚¿ã‚¤ãƒ«è¨­å®šã€‚
        ã“ã“ã¾ã§ã€‚
    ã“ã“ã¾ã§ã€‚
ã“ã“ã¾ã§ã€‚

IDï¼ã€ŒJspreadsheetã€
ã€Œdivã€ã®DOMéƒ¨å“ä½œæˆã€‚
ãã‚Œã®ã€Œidã€ã«IDã‚’DOMå±æ€§è¨­å®šã€‚

ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼ã€
var changed = function(instance, cell, x, y, value) {
    jspreadsheet.getColumnNameFromId([x,y]);
        console.log([instance, cell, x, y, value]);
        sys.__exec("å®Œäº†è¨­å®š",[cell,[x,y],value]);
}

jspreadsheet(document.getElementById(sys.__findVar("ID")), {
    //é …ç›®å
    columns:sys.__findVar("ã‚¿ã‚¤ãƒˆãƒ«"),
    
    //ãƒ‡ãƒ¼ã‚¿
    data:sys.__findVar("ãƒ‡ãƒ¼ã‚¿"),
    
    //ã‚ªãƒ—ã‚·ãƒ§ãƒ³
    minDimensions: [10,10], // æœ€å°[åˆ—,è¡Œ]æ•°
    
    //ã‚¹ã‚¿ã‚¤ãƒ«
    style: sys.__findVar("ã‚¹ã‚¿ã‚¤ãƒ«"),
    
    onchange: changed,
});
ã€ã‚’JSå®Ÿè¡Œã€‚

ã€Œstyleã€ã®DOMéƒ¨å“ä½œæˆã€‚
ãã‚Œã«ã€
#nako3_div .jexcel {
    border-collapse: separate;
    table-layout: fixed;
    white-space:  nowrap;
    empty-cells: show;
    border: 0px;
    background-color: #fff;
    width: 0;

    border-top: 1px solid transparent;
    border-left: 1px solid transparent;
    border-right: 1px solid #ccc;
    border-bottom: 1px solid #ccc;}
#nako3_div .jexcel_container.with-toolbar #nako3_div .jexcel > thead > tr > td {
    top: 0;
}

#nako3_div .jexcel > thead > tr > td
{
    border-top: 1px solid #ccc;
    border-left: 1px solid #ccc;
    border-right: 1px solid transparent;
    border-bottom: 1px solid transparent;
    background-color: #f3f3f3;
    padding: 2px;
    cursor: pointer;
    box-sizing: border-box;
    overflow: hidden;
    position: -webkit-sticky;
    position: sticky;
    top: 0;
    z-index:2;
}

#nako3_div .jexcel > tbody > tr > td
{
    border-top:1px solid #ccc;
    border-left:1px solid #ccc;
    border-right:1px solid transparent;
    border-bottom:1px solid transparent;
    padding:4px;
    white-space: nowrap;
    box-sizing: border-box;
    line-height:1em;
}
#nako3_div .jexcel > thead > tr > td.selected
{
    background-color:#dcdcdc;
}

#nako3_div .jexcel > tbody > tr > td:first-child
{
    position:relative;
    background-color:#f3f3f3;
    text-align:center;
}

#nako3_div .jexcel > tbody > tr.selected > td:first-child
{
    background-color:#dcdcdc;
}
#nako3_div .jexcel > tbody > tr > td > select,
#nako3_div .jexcel > tbody > tr > td > input,
#nako3_div .jexcel > tbody > tr > td > textarea
{
    border:0px;
    border-radius:0px;
    outline:0px;
    width:100%;
    margin:0px;
    padding:0px;
    padding-right:2px;
    background-color:transparent;
    box-sizing: border-box;
}


#nako3_div .jexcel .highlight {
    background-color:rgba(0,0,0,0.05);
}

#nako3_div .jexcel .highlight-selected
{
    background-color:rgba(0,0,0,0.0);
}


#nako3_div .jexcel .highlight-top {
    border-top:1px solid #000; /* var(--jexcel-border-color);*/
    box-shadow: 0px -1px #ccc;
}

#nako3_div .jexcel .highlight-left {
    border-left:1px solid #000; /* var(--jexcel-border-color);*/
    box-shadow: -1px 0px #ccc;
}

#nako3_div .jexcel .highlight-right {
    border-right:1px solid #000; /* var(--jexcel-border-color);*/
}

#nako3_div .jexcel .highlight-bottom {
    border-bottom:1px solid #000; /* var(--jexcel-border-color);*/
}

#nako3_div .jexcel .highlight-top.highlight-left {
    box-shadow: -1px -1px #ccc;
    -webkit-box-shadow: -1px -1px #ccc;
    -moz-box-shadow: -1px -1px #ccc;
}

#nako3_div .jexcel .selection
{
    background-color:rgba(0,0,0,0.05);
}
#nako3_div .jexcel .selection-left
{
    border-left:1px dotted #000;
}
#nako3_div .jexcel .selection-right
{
    border-right:1px dotted #000;
}
#nako3_div .jexcel .selection-top
{
    border-top:1px dotted #000;
}
#nako3_div .jexcel .selection-bottom
{
    border-bottom:1px dotted #000;
}
#nako3_div .jexcel > thead > tr #nako3_div .jexcel_filter > td > input
{
    border:0px;
    width:100%;
    outline:none;
}
ã€ã‚’HTMLè¨­å®šã€‚